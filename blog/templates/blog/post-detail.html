{% extends "_base.html" %}

{% block page_title %}
    {{details.title}}
{% endblock page_title %}

{% block content %}

    <div class="container px-4 bg-light">
        <div class="row py-3">
            <div class="col text-start">
                <h4>{{details.title|safe}}</h4>
                {% if details.text %}
                    <p>{{details.text|safe}}</p>
                {% endif %}
            </div>
        </div>
        {% for detail in details.posts.all %}
            <div class="row py-3">
                <div class="col text-start">
                    {% if detail.sub_title %}
                        <h4 class="mb-3" id="{{detail.id}}">{{ detail.sub_title|safe }}</h4>
                    {% endif %}
                    {% if detail.image %}
                        <img src="{{detail.image.url}}" class="img-fluid mx-auto d-block postimg" alt="fact{{detail.id}}">
                    {% endif %}
                    {% if detail.description %}
                        <p class="mt-3">{{ detail.description|safe }}</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}

        <div class="row py-3">
            <div data-bs-spy="scroll" data-bs-target="#navbar-example2" data-bs-root-margin="0px 0px -40%" data-bs-smooth-scroll="true" class="scrollspy-example bg-body-tertiary p-3 rounded-2" tabindex="0">
                <h4 id="scrollspyHeading1">Comments:</h4>
                <hr>
                <br>
                {%for comment in details.comments.all %}
                    <h6>{{ comment.user.username }} says:</h6>
                    <p>{{ comment.text }}</p>
                    <hr>
                {% endfor %}
            </div>
            <form action="{% url 'comment_create' details.id %}" method="POST" class="row g-3">
                {% csrf_token %}
                <div class="mb-3">
                    <h5>
                        What do you think?
                    </h5>
                    {{ comment_form.text }}
                </div>
                <div class="col-12">
                    {% if user.is_authenticated %}
                        <button type="submit" class="btn btn-primary">Submit</button>
                    {% else %}
                        <p>Please <a href="{% url 'login' %}?next={{request.path}}">Log In</a> to submit your opinion</p>
                    {% endif %}
                </div>
            </form>
        </div>

    </div>

{% endblock content %}